rule "OF_Heater Control"
when
    Item OF_HeatingMode changed or
    Item OF_TemperatureSetpoint changed or
    Item OF_Temperature changed
then
    // 0="Off", 1="On", 2="Auto"
    if (OF_HeatingMode.state == "off") {
        OF_Heater.sendCommand(OFF)
        OF_Heater.postUpdate(OFF)
        //say("Elsie bedroom radiator off")
    }// just single zone in use local setpoint - ignore any global control
    else if ( (OF_HeatingMode.state == "auto") || (OF_HeatingMode.state == "manual") ) { //obey setpoint for that zone
            // get the current setpoint for the nursery
            var Number setpoint = OF_TemperatureSetpoint.state as DecimalType
            // calculate the turn on/off temperatures
            var Number turnOnTemp = setpoint  //- 0.1
            var Number turnOffTemp = setpoint
            var Number temp = OF_Temperature.state as DecimalType
            // determine whether we need to turn on/off the heater
            if (temp < turnOnTemp) {   // turn on temp has been reached so switch on the heater
                OF_Heater.sendCommand(ON)
                OF_Heater.postUpdate(ON)
                //say("Elsie bedroom radiator on")
            }
            else if (temp >= turnOffTemp) {   // turn off temp has been reached so switch off the heater
                OF_Heater.sendCommand(OFF)
                OF_Heater.postUpdate(OFF)
                //say("Elsie bedroom radiator off")
            }
    }
end
