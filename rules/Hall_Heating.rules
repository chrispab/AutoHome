rule "StartUp Our Bedroom Heating"
when
    System started
then
    if (Hall_Heating_Mode ==   (NULL)) {
        Hall_Heating_Mode.postUpdate(2)
    }
end
// 
rule "Hall_Heating mode notify changed"
when
    Item Hall_Heating_Mode changed 
then
        //say("Elsie Bedroom heating mode changed")
end 
// 
rule "Hall_Heating Control"
when
    Item Hall_Heating_Mode changed or
    Item Hall_Heating_Setpoint changed or
    Item Hall_Temperature changed
then
    // 0="Off", 1="On", 2="Auto"
    if (Hall_Heating_Mode.state == 0) {
        Hall_Heating.sendCommand(OFF)
        Hall_Heating.postUpdate(OFF)
        //say("Elsie bedroom radiator off")
    }
    else if (Hall_Heating_Mode.state == 1) {
        Hall_Heating.sendCommand(ON)
        Hall_Heating.postUpdate(ON)
        //say("Elsie bedroom radiator on")
    }
    else if (Hall_Heating_Mode.state == 2) {

            // get the current setpoint for the nursery
            var Number setpoint = Hall_Heating_Setpoint.state as DecimalType

            // calculate the turn on/off temperatures
            var Number turnOnTemp = setpoint  //- 0.1
            var Number turnOffTemp = setpoint

            var Number temp = Hall_Temperature.state as DecimalType

            // determine whether we need to turn on/off the heater
            if (temp < turnOnTemp) {
                // turn on temp has been reached so switch on the heater
                Hall_Heating.sendCommand(ON)
                Hall_Heating.postUpdate(ON)
                //say("Elsie bedroom radiator on")
            }
            else if (temp >= turnOffTemp) {
                // turn off temp has been reached so switch off the heater
                Hall_Heating.sendCommand(OFF)
                Hall_Heating.postUpdate(OFF)
                //say("Elsie bedroom radiator off")
            }
    }
end
