rule "StartUp - set up Item Scene_Goodnight"
when
    System started
then
    Scene_Goodnight.postUpdate(OFF)
end


rule "Goodnight Going to bed"
when
	Item Scene_Goodnight changed from OFF to ON
then
    logInfo("RULE", "goodnight going to bed")
    {sendCommand(CT_FairyLights433Socket, OFF)} //con lights
    {postUpdate(CT_FairyLights433Socket, OFF)}
    {sendCommand(radio, OFF)} //radio
    {postUpdate(radio, OFF)}
    vCT_TVKodiSpeakers.sendCommand(OFF)

    gIkeaLights.sendCommand(0)
    gIkeaLights.postUpdate(0)
    //set rads temps to off
    conservatory_Heating_PresetTempNormal.postUpdate(17.0)
    frontRoom_Heating_PresetTempNormal.postUpdate(14.0)
    elsiesRoom_Heating_PresetTempNormal.postUpdate(17.0)
    attic_Heating_PresetTempNormal.postUpdate(14.0)
    bedroom_Heating_PresetTempNormal.postUpdate(17.0)
    office_Heating_PresetTempNormal.postUpdate(17.0)
    hall_Heating_PresetTempNormal.postUpdate(17.0)
    Heating_UpdateHeaters.sendCommand(ON)    

    createTimer(now.plusSeconds(240), [|
        {sendCommand(DR_FairyLights433Socket, OFF)} // d room lights
        {postUpdate(DR_FairyLights433Socket, OFF)}
        logInfo("RULE", "Item Scene_Goodnight now set to OFF again")
    ])
    logInfo("RULE", "Item Scene_Goodnight received command ON")

    Scene_Goodnight.postUpdate(OFF)
end