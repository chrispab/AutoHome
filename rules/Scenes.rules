rule "Goodnight Going to bed"
when
	Item Scene_Goodnight received command ON
then
    logInfo("RULE", "goodnight going to bed")

    //turn off sockets
    {sendCommand(socketG2_1, OFF)} //con lights
    {postUpdate(socketG2_1, OFF)}
    {sendCommand(socketG2_4, OFF)} //tv
    {postUpdate(socketG2_4, OFF)}
    {sendCommand(socketG2_3, OFF)} // amp
    {postUpdate(socketG2_3, OFF)}    
    {sendCommand(socketG2_2, OFF)} //radio
    {postUpdate(socketG2_2, OFF)}
    {postUpdate(conservatoryTVPower, OFF)}

    
    {sendCommand(gIkeaLights, OFF)} //
    {postUpdate(gIkeaLights, OFF)} 

    //set rads temps to off
    CT_Heating_PresetTempNormal.postUpdate(17.0)
    FR_Heating_PresetTempNormal.postUpdate(14.0)
    E_BR_Heating_PresetTempNormal.postUpdate(17.0)
    Attic_Heating_PresetTempNormal.postUpdate(14.0)
    J_BR_Heating_PresetTempNormal.postUpdate(17.0)
    Office_Heating_PresetTempNormal.postUpdate(17.0)
    Hall_Heating_PresetTempNormal.postUpdate(17.0)
    Heating_UpdateHeaters.sendCommand(ON)    

    // var Timer lightsTimer = null
    createTimer(now.plusSeconds(240), [|
        {sendCommand(socketG1_4, OFF)} // d room lights
        {postUpdate(socketG1_4, OFF)}
        logInfo("RULE", "Item Scene_Goodnight now set to OFF again")

    ])
    logInfo("RULE", "Item Scene_Goodnight received command ON")

    Scene_Goodnight.postUpdate(OFF)
end